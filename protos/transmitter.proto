syntax = "proto3";
package LanDataTransmitter;
option csharp_namespace = "LanDataTransmitter";

service Transmitter {
    rpc Connect (ConnectRequest) returns (ConnectReply);
    rpc Disconnect (DisconnectRequest) returns (DisconnectReply);
    rpc PushText (PushTextRequest) returns (PushTextReply); // C -> S
    rpc PullText (PullTextRequest) returns (stream PullTextReply); // C <- S
}

// Connect

message ConnectRequest {
    string clientName = 1;
}

message ConnectReply {
    bool accepted = 1;
    string clientId = 2;
}

// Disconnect

message DisconnectRequest {
    string clientId = 1;
}

message DisconnectReply {
    bool accepted = 1;
}

// PushText (C -> S)

message PushTextRequest {
    string clientId = 1;
    string text = 2;
    int64 timestamp = 3;
}

message PushTextReply {
    bool accepted = 1;
    string messageId = 2;
}

// PullText (C <- S)

message PullTextRequest {
    string clientId = 1;
}

message PullTextReply {
    bool accepted = 1;
    bool closing = 2; // S requires C to close
    string messageId = 3;
    string text = 4;
    int64 timestamp = 5;
}
